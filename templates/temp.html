<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta http-equiv="X-UA-Compatible" content="ie=edge" />
        <title>Chart</title>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js"></script>
        <!-- Google Fonts -->
        <link
            href="https://fonts.googleapis.com/css?family=Montserrat|Poppins&display=swap"
            rel="stylesheet"
        />
        <style>
            body {
                background-color: rgb(32, 35, 48);
            }

            .dialog {
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                width: 500px;
                display: none;
                border: 2px solid #f0d245;
                padding: 20px;
                background: #390f4e;
                border-radius: 0px 20px 0px 20px;
            }

            #ask-the-expert-p {
                font-family: 'Poppins';
                font-size: 18px;
                color: #ffffff;
                text-align: center;
                margin: 10px 0px;
            }

            .dialog-close {
                width: 100%;
                margin: 10px 0px;
                padding: 5px 0px;
                background: linear-gradient(
                    90deg,
                    rgba(240, 176, 0, 1) 0%,
                    rgba(224, 209, 70, 1) 50%,
                    rgba(240, 176, 0, 1) 100%
                );
                border-style: none;
                border-radius: 0px 10px 0px 10px;
                font-family: 'Poppins', sans-serif;
                font-size: 16px;
            }
        </style>
    </head>
    <body>
        <div class="dialog" id="ask-the-expert-dialog">
            <p id="ask-the-expert-p"></p>
            <button class="dialog-close" id="ask-the-expert-close">
                Close
            </button>
        </div>

        <button id="ask-the-expert">Ask the expert</button>

        <script>
            const button = document.getElementById('ask-the-expert');
            button.addEventListener('click', () => {
                const dialog = document.getElementById('ask-the-expert-dialog');
                dialog.style.display = 'block';

                const askTheExpertRequest = new XMLHttpRequest();
                askTheExpertRequest.onload = () => {
                    let responseObject = null;

                    try {
                        responseObject = JSON.parse(
                            askTheExpertRequest.responseText
                        );
                    } catch (err) {
                        console.log('Could not parse JSON!');
                    }

                    if (responseObject) {
                        if (askTheExpertRequest.status == 200) {
                            console.log(responseObject);
                            const text = document.getElementById(
                                'ask-the-expert-p'
                            );
                            text.innerHTML = `Expert thinks the answer is ${responseObject.answer}`;
                        } else {
                            console.log('Error');
                        }
                    }
                };
                askTheExpertRequest.open(
                    'get',
                    'http://localhost:3000/api/lifelines/asktheexpert/5d6e88234ca2d356b40f2a36',
                    true
                );
                askTheExpertRequest.send();
            });

            const btnClose = document.getElementById('ask-the-expert-close');
            btnClose.addEventListener('click', () => {
                const dialog = document.getElementById('ask-the-expert-dialog');
                dialog.style.display = 'none';
            });
        </script>
    </body>
</html>
